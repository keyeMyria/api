{% extends "pashinin_base.jinja" %}

{% block head %}
{{super()}}
<script defer src="{{ static("js/core_celery.js") }}"></script>
{% endblock %}

{% block header %}
  {{super()}}

<div class="w pad-sm">
  <img class="" alt="Celery" width="64px"
	   src="{{file("beec0e35eb960de1b0159276c7d5f4026145aa5d")}}"/>
  {% if not celery_is_running %}
	Celery is NOT running
  {% endif %}
</div>
{% endblock %}

{% block content %}
<div class="pad-sm">
  {{celery_exe}}
  {# {{inspect.stats()}} #}

  <div class="padtb">
  Processes:
  {# .name()  - 'glusterfs' #}
  {# .cmdline - ['/usr/sbin/glusterfs', '--volfile-server=10.254.239.1', '--volfile-id=/v3', '/mnt/files'] #}
  {# .exe()   - '/usr/sbin/glusterfs' #}
  {% for p in psutil.process_iter() %}
	{# <div>{{p.exe()}}</div> #}
  {% endfor %}
  {% for p in plist %}
	<div>{{p}}</div>
  {% endfor %}
  </div>


  Registered tasks:
  {% for task in registered_tasks %}
	<div>
	  <a class="task" href="">{{task}}</a>
	</div>
  {% else %}
	none
  {% endfor %}

  <div>
	<a id="run_celery" href="{{url("core:celery")}}">Run Celery</a>

	<textarea cols="30" id="log" name="" rows="10"></textarea>
  </div>
</div>
{% endblock %}
